<%- include('../required/header.ejs') %>
<main>
    <main id="block20">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="bx-shadow">
                    <% var displayed = false; %>
								
									<% for (var j = 0; j < rooms.length; j++) { %>
											<% if (id === rooms[j]._id && !displayed) { %>
												<% displayed = true; %>
                    <p class="heading-search font-weight-bold text-left pl-2 pb-0">Search
                        result <span> for </span><span><%= rooms[j].room_name %></span></p>
                        <% } %>
						<% } %>
					
			
                </div>
            </div>

            
            <div class="col-lg-12 col-md-12 col-sm-12 search-div2">
                <div class="bx-shadow2">
                    <div class=" proo pl-4 pr-4 mt-5 ">
                        
                        <div class="table-responsive">
                            <table class="tab pb-4" style="margin:0 auto;">
                                <thead>
                                    <tr>
                                        <th scope="row">Room</th>
                                        
									<% for (var j = 0; j < rooms.length; j++) { %>
                                        <% if (id === rooms[j]._id) { %>
                                        <td scope="row"><%= rooms[j].room_name %></td>
                                    <% } %>
                                    <% } %>
                                    </tr>
                                    <tr>
                                        <th scope="row">Block</th>
                                        <% for (var i = 0; i < blocks.length; i++) { %>
                                            <% for (var j = 0; j < rooms.length; j++) { %>
                                                <% if (rooms[j].blockid === blocks[i]._id) { %>
                                                    <% if (id === rooms[j]._id) { %>
                                        <td scope="row"><%= blocks[i].block_name %></td>
                                        	  
							<% } %>
                            <% } %>
                        <% } %>
                    <% } %>
                                    </tr>
                                    <tr>
                                        <th>capacity</th>
                                        <% for (var j = 0; j < rooms.length; j++) { %>
                                            <% if (id === rooms[j]._id) { %>
                                        <td scope="row"><%= rooms[j].room_capacity %></td>
                                        <% } %>
                                        <% } %>
                                                 
                                    </tr>
                                    <tr>
                                        <th>Type</th>
                                        <% for (var j = 0; j < rooms.length; j++) { %>
                                            <% if (id === rooms[j]._id) { %>
                                        <td scope="row"><%= rooms[j].type === "boys" ? "Boys" : "Girls" %> hostel</td>
                                        <% } %>
                                        <% } %>
                                    </tr>
                                    <tr>
                                        <th style="vertical-align: middle;">Members</th>
                                        <td>
                                            <table  style="width:100%;">
                                                <tr>
                                                  <td style="vertical-align: middle;">Year</td>
                                                  <td style="vertical-align: middle;">Members</td>
                                                </tr>
                                                
                                                <% const uniqueYears = [...new Set(members.membersInRoom.map(member => member.academicyear))];
                                                if (uniqueYears.length > 0) { %>
                                                  <% uniqueYears.forEach(year => { %>
                                                    <tr>
                                                      <td><%= year %></td>
                                                      <td>
                                                        <ul>
                                                          <% members.membersInRoom.forEach(member => {
                                                            if (member.academicyear === year) { %>
                                                              <li><%= member.student_name %></li>
                                                          <% }}); %>
                                                        </ul>
                                                      </td>
                                                    </tr>
                                                  <% }); %>
                                                <% } else { %>
                                                  <tr>
                                                    <td colspan="2">No members</td>
                                                  </tr>
                                                <% } %>
                                              </table>
                                              
                                    </td>




                                    </tr>
                                </thead>                  
                            </table>
                            <br>

                        </div>

                    </div>

                </div>
            </div>
    </main>
</main>
<br><br><br><br><br><br><br><br> <br><br><br><br><br><br><br><br> <br><br><br><br><br><br><br><br>
</section>

</body>

</html>